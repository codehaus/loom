<project default="main"
    xmlns:ant="jelly:ant"
    xmlns:maven="jelly:maven">

    <goal name="main">
        <attainGoal name="build"/>
    </goal>

    <goal name="build">
        <attainGoal name="jar:install"/>
    </goal>

    <goal name="deploy">
        <attainGoal name="jar:deploy"/>
    </goal>

    <postGoal name="test:compile">
        <ant:taskdef name="metagenerate"
            classname="org.jcontainer.loom.info.GenerateLoomDescriptorsTask">
            <ant:classpath>
                <ant:path refid="maven.dependency.classpath"/>
            </ant:classpath>
        </ant:taskdef>
        <ant:echo message="Generating Component Descriptors For Unit Tests"/>
        <ant:mkdir dir="${basedir}/target/test-classes"/>
        <metagenerate destDir="${basedir}/target/test-classes">
            <ant:fileset dir="src/test">
                <include name="**/data/*"/>
            </ant:fileset>
        </metagenerate>
    </postGoal>

</project>
