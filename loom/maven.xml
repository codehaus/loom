<project default="main"
    xmlns:maven="jelly:maven">

    <goal name="main">
        <attainGoal name="build"/>
    </goal>

    <goal name="clean-all">
        <echo message="Cleaning all components"/>
        <maven:reactor
            basedir="${basedir}"
            includes="*/project.xml"
            excludes="demos/*"
            goals="clean"
            banner="Cleaning"
            ignoreFailures="false"/>

        <maven:maven
            descriptor="${basedir}/demos/project.xml"
            goals="clean-all"
            ignoreFailures="false"/>
    </goal>

    <goal name="build">
        <echo message="Build all components"/>
        <maven:reactor
            basedir="${basedir}"
            includes="*/project.xml"
            excludes="distribution/*,demos/project.xml,demos/*/project.xml,integration-test/project.xml"
            goals="clean,build"
            banner="Building"
            ignoreFailures="false"/>
        <maven:maven
            descriptor="${basedir}/distribution/project.xml"
            goals="build"
            ignoreFailures="false"/>
    </goal>

    <goal name="deploy">
        <echo message="Deploying all components"/>
        <maven:reactor
            basedir="${basedir}"
            includes="*/project.xml"
            excludes="distribution/*"
            goals="clean,deploy"
            banner="Deploying"
            ignoreFailures="false"/>
    </goal>

</project>
